---
description: >-
  Hàm cho phép bạn gửi tin nhắn thoại đến 1 số điện thoại bởi file ghi âm đã
  tạo.
---

# Hàm tạo cuộc gọi tự động từ file ghi âm

* HTTP request\
  URL: [http://voiceapi.esms.vn/MainService.svc/json/MakeCallRecord\_V2?ApiKey={ApiKey}\&SecretKey={SecretKey}\&TemplateId={RecordId}\&Phone={Phone}\&SendDate={SendDate}\&NumberForward={NumberForward}\&MaxRepeat={MaxRepeat}\&MaxRetry={MaxRetry}\&Ivr={Ivr}\&TimeWaitToIvr={TimeWaitToIvr}\&WaitRetry={WaitRetry}\&CallbackUrl={CallbackUrl}\&RequestID={RequestId}](http://voiceapi.esms.vn/MainService.svc/json/MakeCallRecord\_V2?ApiKey={ApiKey}\&SecretKey={SecretKey}\&TemplateId={RecordId}\&Phone={Phone}\&SendDate={SendDate}\&NumberForward={NumberForward}\&MaxRepeat={MaxRepeat}\&MaxRetry={MaxRetry}\&Ivr={Ivr}\&TimeWaitToIvr={TimeWaitToIvr}\&WaitRetry={WaitRetry}\&CallbackUrl={CallbackUrl}\&RequestID={RequestId})[  ](http://voiceapi.esms.vn/MainService.svc/json/MakeCallTemplate\_V2?ApiKey={ApiKey}\&SecretKey={SecretKey}\&TemplateId={TemplateId}\&Phone={Phone}\&VariableListStr={VariableListStr}\&SendDate={SendDate}\&Voice={Voice}\&Speed={Speed}\&CallbackUrl={CallbackUrl}\&RequestId={RequestId})\
  Method: GET

{% code overflow="wrap" %}
```
curl --location -g --request GET 'http://voiceapi.esms.vn/MainService.svc/json/MakeCallRecord_V2?ApiKey={ApiKey}&SecretKey={SecretKey}&TemplateId={RecordId}&Phone={Phone}&SendDate={SendDate}&NumberForward={NumberForward}&MaxRepeat={MaxRepeat}&MaxRetry={MaxRetry}&Ivr={Ivr}&TimeWaitToIvr={TimeWaitToIvr}&WaitRetry={WaitRetry}&CallbackUrl={CallbackUrl}&RequestID={RequestId}'
```
{% endcode %}

* Thông tin request

| Biến          | Kiểu dữ liệu          | Định nghĩa                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ------------- | --------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ApiKey        | String                | ApiKey của tài khoản                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| SecretKey     | String                | Secretkey của tài khoản                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| TemplateId    | String                | Id file ghi âm tạo trên trang account.esms.vn                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Phone         | String                | Số điện thoại nhận tin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| NumberForward | String                | Số điện thoại được chuyển đến khi nhập đúng Ivr                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| SendDate      | String                | Đặt lịch gửi tin (định dạng: yyyy/MM/dd hh:mm:ss) Ví dụ: 2017/12/12 14:00:00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| MaxRepeat     | String                | Số lần lặp lại file ghi âm khi nghe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| MaxRetry      | String                | Số lần gọi lại khi người nhận không bắt máy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Ivr           | String                | Phím quy định khi người nhận bấm để chuyển số (phím từ: 0-9)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| TimeWaitToIvr | String                | Thời gian chờ tối đa để người gọi nhấn phím                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| WaitRetry     | String                | Khoảng cách giữa các lần gọi lại khi người nhận không bắt máy (đơn vị: giây)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| CallbackUrl   | String (_URL Encode_) | <p></p><p>Url nhận callback kết quả cuộc gọi (mẫu: <code>https://{{Your_API_Domain}}/Esms/ReceiveVocieCallback?ReferenceId=&#x26;CallDuration=&#x26;CallStatus=&#x26;Ivr=&#x26;Price=&#x26;SentResult=&#x26;CID=&#x26;SendStatus=</code>)</p><ul><li><strong>CallDuration</strong>: độ dài cuộc gọi</li><li><strong>CallStatus</strong>: kết quả cuộc gọi (ANSWERED, NO ANSWER)</li><li><strong>Ivr</strong>: phím bấm của khách hàng</li><li><strong>Price</strong>: giá cuộc gọi</li><li><strong>SentResult</strong>: Kết quả gửi tin qua nhà mạng (0: thất bại, 1: thành công)</li><li><strong>CID</strong>: đầu số gửi tin</li><li><strong>SendStatus</strong>: Trạng thái cuộc gọi: </li></ul><p>            2: Chờ gửi.</p><p>            5: Đã gửi xong.</p><p>            7: Đã gửi chờ báo cáo.</p><p></p><p><strong>Yêu cầu phản hồi</strong>:</p><p>Khi đối tác nhận được dữ liệu, vui lòng trả về trạng thái <strong><code>HTTP_STATUS_CODE=200</code></strong> để xác nhận với ESMS là thành công.</p><p>Nếu không nhận được HTTP_STATUS_CODE 200, ESMS sẽ tiến hành gửi lại tối đa 5 lần.<br><br><em>Ví dụ</em>:<br><code>curl --location --globoff --request GET 'https://{{Your_API_Domain}}/Esms/ReceiveVocieCallback?ReferenceId=066107ee-6ec4-4283-b595-aa74977c65c5&#x26;CallDuration=0&#x26;CallStatus=&#x26;Ivr=&#x26;Price=0.0000&#x26;SentResult=0&#x26;CID=02871002454&#x26;SendStatus=5'</code><br></p> |
| RequestId     | String                | ID Tin nhắn của đối tác, dùng để kiểm tra ID này đã được hệ thống esms tiếp nhận trước đó hay chưa. Ví dụ: requestid=123456                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

* Kết quả trả về

```
{
 "CodeResult": "100",
 "SMSID": "8eb2af6d-fb4c4814-b9cc-4c0e3ed32edf "
}
```

* Thông tin kết quả trả về

| Biến  | Định nghĩa                                                                                        |
| ----- | ------------------------------------------------------------------------------------------------- |
| SMSID | ID của cuộcgoji mới được tạo ra trên hệ thống eSMS. Dùng ID này để query lấy trạng thái cuộc gọi. |
